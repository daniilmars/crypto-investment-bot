name: Health Check

on:
  workflow_dispatch:
  schedule:
    - cron: '0 * * * *'

jobs:
  health-check:
    name: Check Bot Health
    runs-on: ubuntu-latest
    steps:
      - name: Health check
        run: |
          RESPONSE=$(curl -sf --max-time 15 "http://${{ secrets.GCE_INSTANCE_IP }}:8080/health" || true)
          if echo "$RESPONSE" | grep -q '"status"'; then
            echo "Bot is healthy: $RESPONSE"
          else
            echo "::error::Health check failed â€” bot may be down"
            exit 1
          fi
